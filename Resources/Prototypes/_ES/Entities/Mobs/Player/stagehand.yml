- type: entity
  parent:
  - Incorporeal
  - BaseMob
  id: ESMobStagehand
  name: stagehand
  description: Every show needs a loyal crew in the back making it tick. Today, that person is you.
  components:
  - type: Sprite
    sprite: _ES/Mobs/Ghosts/theatergoer.rsi
    layers:
    - state: stagehand
      shader: unshaded
    - state: head-1
      map: [ "face" ]
      shader: unshaded
  - type: RandomSprite
    available:
    - face:
        head-1: ""
        head-2: ""
        head-3: ""
        head-4: ""
        head-5: ""
        head-6: ""
        head-7: ""
  - type: ContentEye
    maxZoom: 1.44,1.44
  - type: Eye
    drawFov: false
    visMask:
    - Normal
    - Ghost
  - type: Input
    context: "ghost"
  - type: Visibility
    layer: 2 #ghost vis layer
  - type: Examiner
    skipChecks: true
  - type: Ghost # TODO: reason about the implications of this
    toggleLightingAction: ESActionStagehandChangeLighting
    toggleFoVAction: ESActionStagehandToggleFOV
    deleteOnDetach: false
  - type: ESStagehand
  - type: ESUsernameEntityName
  - type: ESMindVisuals
  - type: ESBlockInteraction
  - type: ShowElectrocutionHUD
  - type: ShowAntagIcons
  - type: UserInterface
    interfaces:
      enum.ESVoterUiKey.Key:
        type: ESVoterBui
      enum.ESStagehandUiKey.Observe:
        type: ESStagehandObserveBui
  - type: IntrinsicUI
    uis:
      enum.ESStagehandUiKey.Observe:
        toggleAction: ESActionStagehandObserve
      enum.ESVoterUiKey.Key:
        toggleAction: ESActionStagehandVote
  - type: ESVoter
  - type: IntrinsicRadioReceiver
  - type: ActiveRadio
    receiveAllChannels: true
    globalReceive: true
  - type: ESInherentLight
    lightPrototype: ESMobObserverInherentLight
    enabled: false
  - type: Tag
    tags:
    - BypassInteractionRangeChecks

- type: entity
  parent: BaseMentalAction
  id: ESActionStagehandVote
  name: Vote
  description: Control the flow of the round alongside other stagehands.
  components:
  - type: Action
    icon:
      sprite: _ES/Actions/stagehands.rsi
      state: ballot
    checkCanInteract: false
    checkConsciousness: false
  - type: InstantAction
    event: !type:ToggleIntrinsicUIEvent
      key: enum.ESVoterUiKey.Key

- type: entity
  parent: BaseMentalAction
  id: ESActionStagehandObserve
  name: Observe
  description: Learn the behind-the-scenes about the actors on stage.
  components:
  - type: Action
    icon:
      sprite: _ES/Actions/stagehands.rsi
      state: observe
    checkCanInteract: false
    checkConsciousness: false
  - type: InstantAction
    event: !type:ToggleIntrinsicUIEvent
      key: enum.ESStagehandUiKey.Observe

- type: entity
  parent: BaseMentalAction
  id: ESActionStagehandChangeLighting
  name: Change Lighting
  description: Changes the lighting to help you see in the dark.
  components:
  - type: Action
    icon:
      sprite: Objects/Power/light_bulb.rsi
      state: normal
    clientExclusive: true
  - type: InstantAction
    event: !type:ToggleLightingActionEvent

- type: entity
  parent: BaseMentalAction
  id: ESActionStagehandToggleFOV
  name: Toggle FoV
  description: Toggles field-of-view in order to see what players see.
  components:
  - type: Action
    icon:
      sprite: _ES/Actions/stagehands.rsi
      state: fov-off
    iconOn: # BUG: Currently does not work due to network issues with toggling on client
      sprite: _ES/Actions/stagehands.rsi
      state: fov-on
    clientExclusive: true
  - type: InstantAction
    event: !type:ToggleFoVActionEvent
